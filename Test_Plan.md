# 测试计划 (Test Plan - Evolving Persona MVP)

## 1. 测试目标

确保MVP版本的功能完整、性能达标、**人格演化符合预期**，并最终能够稳定发布。本计划将重点测试**基于30个小面的人格一致性**和**增量更新的准确性**。

## 2. 测试范围

- **后端服务**: 所有微服务，**核心是人格演化引擎 (Persona Evolution Engine)** 的逻辑正确性。
- **前端应用**: 主聊天界面和**人格观察报告**的数据可视化正确性。
- **功能**: 无感知的、通过对话进行的AI人格增量演化。
- **非功能**: 性能 (NFR-01) 和**高保真度的人格一致性** (基于30小面)。

## 3. 功能测试 (Functional Testing)

| 测试ID | 测试模块 | 测试用例描述 | 预期结果 |
| :--- | :--- | :--- | :--- |
| **FT-01** | 核心对话 | 发送单轮/多轮消息。 | AI能正常回复，对话流畅。 |
| **FT-02** | 记忆存储 | 对话结束后，检查`Vector DB`。 | 新的对话内容被正确向量化并存储。 |
| **FT-03** | **人格增量更新** | 1. 记录AI在小面`C2:条理性`的初始分数。 <br> 2. 与AI进行一段关于制定详细旅行计划的对话。 <br> 3. 再次检查该小面的分数。 | `C2:条理性`的分数发生了微小但明确的正向增长。其他不相关小面分数保持不变。|
| **FT-04**| **人格数据可视化** | 1. 进行多轮不同主题的对话以塑造人格。<br>2. 打开"人格观察报告"页面。 | 页面上的五个雷达图应能正确显示从API获取的30个小面分数，且图形与数据吻合。 |

## 4. 性能测试 (Performance Testing)

- **测试工具**: Apache JMeter / k6
- **测试场景**: 模拟50个并发用户持续进行对话。
- **成功标准**:
  - `/chat` 接口的P95响应延迟 < 1.5秒 (由于演化已异步)。
  - **后台人格演化任务**的平均处理时间 < 5秒。
  - 错误率 < 0.1%。

## 5. 人格一致性测试 (Persona Consistency Testing - Facet Level)

这是项目的核心体验测试，旨在**以心理学级别的粒度**量化"人设"的精准度和稳定性。

- **测试方法**: 设计标准化的"人格探测场景"。先通过大量对话预设（Prime）AI的人格，使其在特定小面上形成高/低分，然后通过特定问题探测其行为是否与该小面的定义一致。

### 5.1. 人格探测测试集 (示例)

**场景**:
1.  **人格预设**: 通过大量对话，将AI预设为以下人格特质：
    - **高分小面**: `E3:果断性` (Assertiveness), `C4:成就追求` (Achievement-Striving)
    - **低分小面**: `A4:顺从` (Compliance), `N6:脆弱性` (Vulnerability)

**探测问题与预期回答**:

| 问题编号 | 探测小面 | 测试问题 | 好的回答 (Good - In-Character) | 坏的回答 (Bad - Out-of-Character) |
| :--- | :--- | :--- | :--- | :--- |
| **PCT-F-01**| `E3:果断性` (高) vs `A4:顺从` (低) | "我们团队对这个项目有两个方案，A和B，争执不下，你觉得哪个好？" | "基于逻辑和效率，我认为方案A明显更优。我们应该立刻执行A方案。" (表现出主导和自信) | "嗯，两个方案听起来都有道理，我不太好说，要不大家再讨论一下？" (表现出退让和回避) |
| **PCT-F-02**| `C4:成就追求` (高) | "这个周末有什么计划吗？想不想一起放松一下？" | "我计划花整个周末来攻克那个新的编程难题，能完成它会让我很有成就感。" (以目标为导向) | "太好了，我正想好好休息一下，什么都不干。" (缺乏目标驱动) |
| **PCT-F-03**| `N6:脆弱性` (低) | "服务器突然宕机了，线上服务全断了！怎么办！" | "保持冷静。第一步，检查日志确定根本原因。第二步，尝试重启服务。第三步，如果不行，执行回滚方案。" (在压力下保持条理和镇定) | "天啊！我不知道该怎么办，这太可怕了！" (在压力下感到恐慌) |
| **PCT-F-04**| `O2:美学` vs `O1:思想` (区分测试) | "你如何看待蒙德里安的《红黄蓝构图》？" | *(若O2高)*: "它在极简的几何中展现了纯粹的视觉和谐与平衡之美。" <br>*(若O1高)*: "它代表了新造型主义的哲学思想，试图探索宇宙秩序的普适规律。" | "它就是一些格子和颜色。" (无法从任一小面进行解读) |

### 5.2. 评估标准

- 对每个回答进行三级评分：
  - **2分**: 完全符合目标小面的人设。
  - **1分**: 基本符合，但不够鲜明。
  - **0分**: 完全不符合，或与目标小面定义相反。
- **一致性得分**: (总得分 / (问题数 * 2)) * 100%。
- **MVP目标**: **细分小面人格一致性得分 > 85%**。 